<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="zhywyt" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="zhywyt&#39;s blog">
<meta property="og:url" content="https://hexothemedemo.github.io/Yelee/index.html">
<meta property="og:site_name" content="zhywyt&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="zhywyt">
<meta name="twitter:card" content="summary">

<link rel="apple-touch-icon" href= "/Yelee//apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="zhywyt&#39;s blog" type="application/atom+xml">



    <link rel="shortcut icon" href="/Yelee//favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/Yelee/css/style.css">



    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>zhywyt&#39;s blog</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: 
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = /Yelee/; </script>






<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/Yelee/" class="profilepic">
            <img src="/Yelee//img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/Yelee/"></a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/Yelee//Yelee/">主页</a></li>
                        
                            <li><a href="/Yelee//Yelee/archives/">所有文章</a></li>
                        
                            <li><a href="/Yelee//Yelee/tags/">标签云</a></li>
                        
                            <li><a href="/Yelee//Yelee/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/Yelee/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/Yelee/tags/encrypt/" rel="tag">encrypt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Yelee/tags/%E5%8D%9A%E5%AE%A2/" rel="tag">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Yelee/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" rel="tag">技术文档</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Yelee/tags/%E8%AF%97%E4%B8%8E%E6%95%A3%E6%96%87/" rel="tag">诗与散文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/Yelee/tags/%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3/" rel="tag">错误解决</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/Yelee/" class="profilepic">
                <img src="/Yelee//img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/Yelee/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/Yelee/">主页</a></li>
                
                    <li><a href="/Yelee/archives/">所有文章</a></li>
                
                    <li><a href="/Yelee/tags/">标签云</a></li>
                
                    <li><a href="/Yelee/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:123@123.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/Yelee/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-游戏开发/Unity/shader/在Unity2D中创建角色描边的shader思路" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/10907/" class="article-date">
      <time datetime="2025-03-17T04:11:36.441Z" itemprop="datePublished">2025-03-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/10907/">在Unity2D中创建角色描边的shader思路</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我看到过很多角色描边的博客，大部分在讲3D的角色描边，在3D的情况下，最好的办法就是使用法线外扩+两次Pass来实现描边。简单来说就是因为模型有法线，那么顶点就会有法向，可以直接向外扩展部分，并额外渲染一个描边色的、不带正面的描边层，然后正常使用第二个Pass渲染模型本身就可以了。</p>
<p>而在2D中，没有模型，只有图片，并且图片也不存在硬边界，大部分的图片都是由一个简单的多边形加上扣掉无用的点组成的，这里给一个简单的例子来说明：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">&quot;Hidden/test&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties</span><br><span class="line">    &#123;</span><br><span class="line">        _MainTex (<span class="string">&quot;Texture&quot;</span>, <span class="number">2</span>D) = <span class="string">&quot;white&quot;</span> &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader</span><br><span class="line">    &#123;</span><br><span class="line">        Cull Off ZWrite Off ZTest Always</span><br><span class="line">        Tags &#123; <span class="string">&quot;Queue&quot;</span> = <span class="string">&quot;Transparent&quot;</span> &#125;</span><br><span class="line">        Pass<span class="comment">//---------------------------渲染图片边框-----------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> vertex vert</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> fragment frag</span></span><br><span class="line">            <span class="meta">#include &quot;UnityCG.cginc&quot;</span></span><br><span class="line">            <span class="keyword">struct</span> appdata</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">struct</span> v2f</span><br><span class="line">            &#123;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">                float4 vertex : SV_POSITION;</span><br><span class="line">            &#125;;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            fixed4 _MainTex_ST;</span><br><span class="line">            <span class="function">v2f <span class="title">vert</span> (<span class="params">appdata v</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br><span class="line">                o.uv = v.uv;</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span> (<span class="params">v2f i</span>) : SV_Target</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 白色</span></span><br><span class="line">                fixed4 col = fixed4(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> col;</span><br><span class="line">            &#125;</span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>选择一个附带透明像素的图片，将他赋予这个材质，你就会发现其实图片的边缘和我们看到的其实不一样。所以我们不能简单的通过控制顶点来实现我们的边缘效果。<br><img src="/Yelee/../../../../assets/images/QQ_1736946315527.png"><br>强行控制会得到如下效果，可以看出并不能覆盖我们的源图片。<br><img src="/Yelee/../../../../assets/images/QQ_1736946970389.png"><br><img src="/Yelee/../../../../assets/images/QQ_1736946979485.png"><br>那我们该怎么做呢？</p>
<h2 id="向像素边缘内收缩"><a href="#向像素边缘内收缩" class="headerlink" title="向像素边缘内收缩"></a>向像素边缘内收缩</h2><p>这个方法的思路就是判断&#x3D;&#x3D;非透明像素&#x3D;&#x3D;的边缘像素，我们需要判断周围的像素中是否有透明像素即可。代码实现也是非常的简单，一个Pass就可以解决。直接上代码：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">&quot;Custom/OutLineShader&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties</span><br><span class="line">    &#123;</span><br><span class="line">        _MainTex (<span class="string">&quot;Texture&quot;</span>, <span class="number">2</span>D) = <span class="string">&quot;white&quot;</span> &#123;&#125;</span><br><span class="line">        _OutLineWidth(<span class="string">&quot;OutLineWidth&quot;</span>,Range(<span class="number">0</span>,<span class="number">5</span>)) = <span class="number">0.1</span></span><br><span class="line">        _OutLineColor(<span class="string">&quot;OutLineColor&quot;</span>,Color)=(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader</span><br><span class="line">    &#123;</span><br><span class="line">        Tags&#123;</span><br><span class="line">            <span class="string">&quot;Queue&quot;</span> = <span class="string">&quot;Geometry-20&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭剔除，让双面都能显示</span></span><br><span class="line">        Cull off</span><br><span class="line">        <span class="comment">// 开启混合</span></span><br><span class="line">        Blend SrcAlpha OneMinusSrcAlpha</span><br><span class="line">        Pass</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 关闭深度测试，使用Queue=Geometry-20的队列(用于2D游戏)</span></span><br><span class="line">            ZWrite off</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            <span class="meta">#include &quot;UnityCG.cginc&quot;</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> vertex vert</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> fragment frag</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">struct</span> inputV</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">struct</span> outputV</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">             &#125;;</span><br><span class="line">             sampler2D _MainTex;</span><br><span class="line">             float4 _MainTex_TexelSize;</span><br><span class="line">             <span class="built_in">float</span> _OutLineWidth;</span><br><span class="line">             float3 _OutLineColor;</span><br><span class="line">            <span class="function">outputV <span class="title">vert</span>(<span class="params">inputV v</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                outputV o;</span><br><span class="line">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br><span class="line">                o.uv = v.uv;</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span>(<span class="params">outputV i</span>) : SV_Target</span></span><br><span class="line">            &#123;</span><br><span class="line">                fixed4 col = tex2D(_MainTex, i.uv);</span><br><span class="line">                float2 uv_up = i.uv + _MainTex_TexelSize.xy * float2(<span class="number">0</span>,<span class="number">1</span>) * _OutLineWidth;</span><br><span class="line">                float2 uv_down = i.uv + _MainTex_TexelSize.xy * float2(<span class="number">0</span>,<span class="number">-1</span>) * _OutLineWidth;</span><br><span class="line">                float2 uv_left = i.uv + _MainTex_TexelSize.xy * float2(<span class="number">-1</span>,<span class="number">0</span>) * _OutLineWidth;</span><br><span class="line">                float2 uv_right = i.uv + _MainTex_TexelSize.xy * float2(<span class="number">1</span>,<span class="number">0</span>) * _OutLineWidth;</span><br><span class="line">                </span><br><span class="line">                <span class="built_in">float</span> w =  tex2D(_MainTex, uv_up).a * tex2D(_MainTex, uv_down).a * tex2D(_MainTex, uv_left).a * tex2D(_MainTex, uv_right).a;</span><br><span class="line">                <span class="comment">// 描边</span></span><br><span class="line">                col.rgb = lerp(_OutLineColor.rgb,col.rgb,w);</span><br><span class="line">                <span class="keyword">return</span> col;</span><br><span class="line">            &#125;</span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>是的，为了不出现不需要的开销，无论我们设置描边的大小为多少，我们都只采样材质五次，也就是说向周围的四个点采样，而不会逐像素采样（他们的区别是一个需要采样多次，而一个在描边宽度很大的时候会出现错误的结果。）<br>效果如下；</p>
<p><img src="/Yelee/../../../../assets/images/QQ_1737019512511.png"><br><img src="/Yelee/../../../../assets/images/QQ_1737019522407.png"><br>优点是快速、任何图片都可以使用，并且边缘比较均匀。缺点显而易见，它改变了图形原来的样子，向内侵占了部分像素。</p>
<h2 id="图片偏移渲染边缘"><a href="#图片偏移渲染边缘" class="headerlink" title="图片偏移渲染边缘"></a>图片偏移渲染边缘</h2><p>既然不能控制顶点的移动，那么我们把图片简单的平移，正常渲染位置就好了。问题就是这种做法的成本还是有点太高了（（（<br>代码我就只写一部分了，毕竟有四个高度重合的Pass：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">&quot;Hidden/test&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties</span><br><span class="line">    &#123;</span><br><span class="line">        _MainTex (<span class="string">&quot;Texture&quot;</span>, <span class="number">2</span>D) = <span class="string">&quot;white&quot;</span> &#123;&#125;</span><br><span class="line">        _BorderColor(<span class="string">&quot;BorderColor&quot;</span>,Color)=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        _Offset(<span class="string">&quot;Offset&quot;</span>,Range(<span class="number">0</span>,<span class="number">1</span>)) = <span class="number">0.05</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader</span><br><span class="line">    &#123;</span><br><span class="line">        Cull Off ZWrite Off</span><br><span class="line">        Tags &#123; <span class="string">&quot;Queue&quot;</span> = <span class="string">&quot;Transparent&quot;</span> &#125;</span><br><span class="line">        <span class="comment">// 混合</span></span><br><span class="line">        Blend SrcAlpha OneMinusSrcAlpha</span><br><span class="line">        pass<span class="comment">//----------------------渲染上边缘------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> vertex vert</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> fragment frag</span></span><br><span class="line">            <span class="meta">#include &quot;UnityCG.cginc&quot;</span></span><br><span class="line">            <span class="keyword">struct</span> appdata</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">struct</span> v2f</span><br><span class="line">            &#123;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">                float4 vertex : SV_POSITION;</span><br><span class="line">            &#125;;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            fixed4 _MainTex_ST;</span><br><span class="line">            fixed4 _BorderColor;</span><br><span class="line">            <span class="built_in">float</span> _Offset;</span><br><span class="line">            <span class="function">v2f <span class="title">vert</span> (<span class="params">appdata v</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br><span class="line">                o.vertex.y += _Offset;</span><br><span class="line">                o.uv = v.uv;</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span> (<span class="params">v2f i</span>) : SV_Target</span></span><br><span class="line">            &#123;</span><br><span class="line">                fixed4 col = _BorderColor*tex2D(_MainTex, i.uv).a;</span><br><span class="line">                <span class="keyword">return</span> col;</span><br><span class="line">            &#125;</span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">        pass<span class="comment">//----------------------渲染右边缘------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">			...</span><br><span class="line">        &#125;</span><br><span class="line">        pass<span class="comment">//---------------------渲染下边缘-------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">			...</span><br><span class="line">        &#125;</span><br><span class="line">        pass<span class="comment">//---------------------渲染左边缘-------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">			...</span><br><span class="line">        &#125;</span><br><span class="line">        pass<span class="comment">//------------------渲染模型本身----------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> vertex vert</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> fragment frag</span></span><br><span class="line">            <span class="meta">#include &quot;UnityCG.cginc&quot;</span></span><br><span class="line">            <span class="keyword">struct</span> appdata</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">struct</span> v2f</span><br><span class="line">            &#123;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">                float4 vertex : SV_POSITION;</span><br><span class="line">            &#125;;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            fixed4 _MainTex_ST;</span><br><span class="line">            <span class="function">v2f <span class="title">vert</span> (<span class="params">appdata v</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br><span class="line">                o.uv = v.uv;</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span> (<span class="params">v2f i</span>) : SV_Target</span></span><br><span class="line">            &#123;</span><br><span class="line">                fixed4 col = tex2D(_MainTex, i.uv);</span><br><span class="line">                <span class="keyword">return</span> col;</span><br><span class="line">            &#125;</span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/Yelee/../../../../assets/images/QQ_1737020450730.png"><br>效果是很不错的，就是渲染需要整整四个Pass，实在不是太优雅，并且不能出现太大的描边，而且对很细的描边没办法很好处理：<br><img src="/Yelee/../../../../assets/images/Pasted%20image%2020250116175454.png"></p>
<h2 id="判断边缘变透明像素为边界法"><a href="#判断边缘变透明像素为边界法" class="headerlink" title="判断边缘变透明像素为边界法"></a>判断边缘变透明像素为边界法</h2><p>故名思意，判断&#x3D;&#x3D;透明像素&#x3D;&#x3D;是否为边缘像素，那么将该透明像素设置为边界颜色。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">Shader <span class="string">&quot;Hidden/test&quot;</span></span><br><span class="line">&#123;</span><br><span class="line">    Properties</span><br><span class="line">    &#123;</span><br><span class="line">        _MainTex (<span class="string">&quot;Texture&quot;</span>, <span class="number">2</span>D) = <span class="string">&quot;white&quot;</span> &#123;&#125;</span><br><span class="line">        _BiggerBorder(<span class="string">&quot;BiggerBorder&quot;</span>,Range(<span class="number">0</span>,<span class="number">1</span>)) = <span class="number">0.5</span></span><br><span class="line">        _Offset(<span class="string">&quot;Offset&quot;</span>,Range(<span class="number">0</span>,<span class="number">1</span>)) = <span class="number">0.05</span></span><br><span class="line">    &#125;</span><br><span class="line">    SubShader</span><br><span class="line">    &#123;</span><br><span class="line">        Cull Off ZWrite Off</span><br><span class="line">        Tags &#123; <span class="string">&quot;Queue&quot;</span> = <span class="string">&quot;Transparent&quot;</span> &#125;</span><br><span class="line">        Pass<span class="comment">//---------------------------渲染图片边框-----------------------------</span></span><br><span class="line">        &#123;</span><br><span class="line">            CGPROGRAM</span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> vertex vert</span></span><br><span class="line">            <span class="meta">#<span class="keyword">pragma</span> fragment frag</span></span><br><span class="line">            <span class="meta">#include &quot;UnityCG.cginc&quot;</span></span><br><span class="line">            <span class="keyword">struct</span> appdata</span><br><span class="line">            &#123;</span><br><span class="line">                float4 vertex : POSITION;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">struct</span> v2f</span><br><span class="line">            &#123;</span><br><span class="line">                float2 uv : TEXCOORD0;</span><br><span class="line">                float4 vertex : SV_POSITION;</span><br><span class="line">            &#125;;</span><br><span class="line">            sampler2D _MainTex;</span><br><span class="line">            fixed4 _MainTex_ST;</span><br><span class="line">            <span class="built_in">float</span> _Offset;</span><br><span class="line">            <span class="built_in">float</span> _BiggerBorder;</span><br><span class="line">            <span class="function">v2f <span class="title">vert</span> (<span class="params">appdata v</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                v2f o;</span><br><span class="line">                <span class="comment">// 顶点向外偏移，不是向上偏移</span></span><br><span class="line">                v.vertex.xy += normalize(v.vertex.xy) * _BiggerBorder;</span><br><span class="line">                o.vertex = UnityObjectToClipPos(v.vertex);</span><br><span class="line">                <span class="comment">// 重采样uv</span></span><br><span class="line">                <span class="comment">// o.uv = TRANSFORM_TEX(v.uv, _MainTex);</span></span><br><span class="line">                o.uv = v.uv;</span><br><span class="line">                <span class="keyword">return</span> o;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function">fixed4 <span class="title">frag</span> (<span class="params">v2f i</span>) : SV_Target</span></span><br><span class="line">            &#123;</span><br><span class="line">                fixed4 col = tex2D(_MainTex, i.uv);</span><br><span class="line">                <span class="keyword">if</span>(col.a &gt; <span class="number">0.5</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> col;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>        <span class="comment">// 透明像素边界判断</span></span><br><span class="line">                &#123;</span><br><span class="line">                    fixed4 up = tex2D(_MainTex, i.uv + float2(<span class="number">0</span>, _Offset));</span><br><span class="line">                    fixed4 down = tex2D(_MainTex, i.uv - float2(<span class="number">0</span>, _Offset));</span><br><span class="line">                    fixed4 left = tex2D(_MainTex, i.uv - float2(_Offset, <span class="number">0</span>));</span><br><span class="line">                    fixed4 right = tex2D(_MainTex, i.uv + float2(_Offset, <span class="number">0</span>));</span><br><span class="line">                    <span class="keyword">if</span>(up.a &gt; <span class="number">0.5</span> || down.a &gt; <span class="number">0.5</span> || left.a &gt; <span class="number">0.5</span> || right.a &gt; <span class="number">0.5</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">return</span> fixed4(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    discard;</span><br><span class="line">                    <span class="keyword">return</span> fixed4(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ENDCG</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>效果与第一种方法不同，不会出现侵占纹理像素的情况，但是会被图片的边界所节点描边，导致描边不均匀。<br><img src="/Yelee/../../../../assets/images/QQ_1737019859028.png"><br><img src="/Yelee/../../../../assets/images/QQ_1737019882304.png"><br>不过这种方法也不失为一种好办法，因为可以在纹理图很细的时候实现比较好的效果，它不会修改任何的纹理上的像素。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Windows/Listary——不仅仅是搜索器" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/5993/" class="article-date">
      <time datetime="2025-03-17T04:11:36.433Z" itemprop="datePublished">2025-03-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/5993/">Listary——不仅仅是搜索器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>你是否受够了Windows的shit搜索？缓慢、不准确、无法模糊搜素……它除了能使用<code>WIN</code>键打开以外我找不到任何一个优点。</p>
<h2 id="使用Listary搜索"><a href="#使用Listary搜索" class="headerlink" title="使用Listary搜索"></a>使用Listary搜索</h2><p>现在<a target="_blank" rel="noopener" href="https://www.listary.com/">Listary – Free File Search Tool &amp; App Launcher</a>摆在了你的眼前：只需要轻敲两次<code>Ctrl</code>键就能随时唤起你的搜索助手<br><img src="/Yelee/../../assets/images/QQ_1734436455138.png" alt="Listary桌面查找示例"><br>当然，就算我正在写这篇博客：我也能立刻查找到它<br><img src="/Yelee/../../assets/images/QQ_1734436526996.png" alt="Listary软件使用中查找示例"><br>不仅是精准的搜索，它有强大的模糊搜索能力，比如拼音<br><img src="/Yelee/../../assets/images/QQ_1734436645839.png"><br>比如跨字<br><img src="/Yelee/../../assets/images/QQ_1734436671752.png"></p>
<h2 id="全屏屏蔽搜索设置"><a href="#全屏屏蔽搜索设置" class="headerlink" title="全屏屏蔽搜索设置"></a>全屏屏蔽搜索设置</h2><p>你可以设置在软件全局的时候屏蔽搜索<br><img src="/Yelee/../../assets/images/QQ_1734436841439.png"></p>
<h2 id="自定义命令"><a href="#自定义命令" class="headerlink" title="自定义命令"></a>自定义命令</h2><p>Listary给我提供了另一个无与伦比的便利——自定义命令，它可以将自定义热键绑定在你的自定义命令上！比如打开终端这件事情。在Ubuntu上，我从来都是使用<code>Ctrl+Alt+T</code>来打开终端的，但是在WIndows上，我已经受够了使用<code>Win+R</code>再加<code>cmd</code>来打开它了。这无疑是缓慢的。要设置自定义命令，你需要找到你的Listary程序，右键打开选项：<br><img src="/Yelee/../../assets/images/QQ_1734437001765.png"><br>在这里，你可以非常方便的设置你的热键与对应的自定义命令：<br><img src="/Yelee/../../assets/images/QQ_1734437062608.png"><br>快去尝试一下吧！使用独属于你的快捷方式！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-关于博客/我的编辑器" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/51899/" class="article-date">
      <time datetime="2025-03-17T04:11:36.433Z" itemprop="datePublished">2025-03-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/51899/">我的编辑器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="2024-12-15"><a href="#2024-12-15" class="headerlink" title="2024-12-15"></a>2024-12-15</h1><p>今天来记录一下自己使用的编辑器——<a target="_blank" rel="noopener" href="https://obsidian.md/">Obsidian - Sharpen your thinking</a>，这是一款让我爱不释手的编辑器。<br>我的既然是和博客有关的编辑器，那肯定是指<code>markdown编辑器</code>了。我对编辑器有几点要求：</p>
<ul>
<li>可拓展</li>
<li>可VIM</li>
<li>可同步</li>
<li>可源代码编辑<br>而Obsidian完美的完成了所有的这些任务，并且给我带来了更多不一样的体验（原生和插件）包括：</li>
<li>当前时间插入<a target="_blank" rel="noopener" href="https://github.com/Gru80/obsidian-timestamper">timestamper</a>：<ul>
<li>2024-12-15</li>
<li>2024-12-15 11:05:02</li>
</ul>
</li>
<li>模板创建文章（原生插件）<ul>
<li>日记（主要用途）</li>
<li>TODO翻滚<a target="_blank" rel="noopener" href="https://github.com/lumoe/obsidian-rollover-daily-todos">rollover daily todos</a>（可以将前一天的TODO直接加入新的日记中）</li>
</ul>
</li>
<li>链接自动获取标题<a target="_blank" rel="noopener" href="https://github.com/zolrath/obsidian-auto-link-title">auto link title</a></li>
<li>远程同步<a target="_blank" rel="noopener" href="https://github.com/remotely-save/remotely-save">remotely save</a></li>
<li>VIM编辑（原生插件）</li>
<li>自动生成<a target="_blank" rel="noopener" href="https://github.com/zigahertz/obsidian-hash">hash</a><ul>
<li>0d7a719180ed</li>
</ul>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/Yelee/categories/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/">关于博客</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Yelee/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" rel="tag">技术文档</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-游戏开发/Unity/shader/在Unity2D中创建屏幕扫描线的shader思路" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/0/" class="article-date">
      <time datetime="2025-03-17T04:11:36.433Z" itemprop="datePublished">2025-03-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
          
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-关于博客/闲鱼搭建记录/anzhiyu" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/64880/" class="article-date">
      <time datetime="2025-03-16T15:36:00.000Z" itemprop="datePublished">2025-03-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/64880/">anzhiyu主题搭建记录</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="来自闲🐟老板芬达的订单"><a href="#来自闲🐟老板芬达的订单" class="headerlink" title="来自闲🐟老板芬达的订单"></a>来自闲🐟老板芬达的订单</h1><p>要求使用 github page 搭建安知鱼主题： <a target="_blank" rel="noopener" href="https://docs.anheyu.com/intro.html">主题简介 | 安知鱼主题官方文档</a></p>
<p>先安装nodejs<br><a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn">Node.js — 在任何地方运行 JavaScript</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装hexo</span></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"><span class="built_in">mkdir</span> <span class="built_in">dir</span></span><br><span class="line"><span class="built_in">cd</span> <span class="built_in">dir</span></span><br><span class="line">hexo init</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">git <span class="built_in">clone</span> -b main https://github.com/anzhiyu-c/hexo-theme-anzhiyu.git themes/anzhiyu</span><br><span class="line"></span><br><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br><span class="line"><span class="built_in">cp</span> -rf ./themes/anzhiyu/_config.yml ./_config.anzhiyu.yml</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改配置文件主题到<code>anzhiyu</code></p>
<p>创建github仓库，打开仓库page，创建机器ssh key。</p>
<p>修改配置文件，设置deploy:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:  </span><br><span class="line">  <span class="built_in">type</span>: git  </span><br><span class="line">  repo: &lt;repository url&gt; <span class="comment"># https://bitbucket.org/JohnSmith/johnsmith.bitbucket.io  </span></span><br><span class="line">  branch: [branch]  </span><br></pre></td></tr></table></figure>

<p>推送<code>hexo d</code></p>
<p>效果预览：<a target="_blank" rel="noopener" href="https://fenda2.github.io/">Hexo</a><br>老板反馈：<br><img src="/Yelee/../../../assets/images/QQ_1742110666829.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/Yelee/categories/%E9%97%B2%E9%B1%BC%E5%85%BC%E8%81%8C/">闲鱼兼职</a><a class="article-category-link" href="/Yelee/categories/%E9%97%B2%E9%B1%BC%E5%85%BC%E8%81%8C/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/">网站搭建</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-关于博客/https/使用HTTPS" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/usehttps/" class="article-date">
      <time datetime="2025-03-14T22:14:00.000Z" itemprop="datePublished">2025-03-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/usehttps/">使用HTTPS</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如果正常的话，我当前的域名应该是：<a target="_blank" rel="noopener" href="https://hexo.zhywyt.me,为了庆祝我找到了免费的https方案,特地来写下这篇文章./">https://hexo.zhywyt.me，为了庆祝我找到了免费的https方案，特地来写下这篇文章。</a></p>
<p>话不多说展示军火：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- frp</span><br><span class="line">- nginx</span><br><span class="line">- acme.sh</span><br><span class="line">- ZeroSSL/Let&#x27;s Encrypt</span><br></pre></td></tr></table></figure>

<p>具体思路是，使用<code>nginx</code>做本地的两个服务，一个是<code>81</code>端口的<a target="_blank" rel="noopener" href="https://www.cnblogs.com/larrydpk/p/12819231.html">http转https服务</a>，一个是正常的<code>80</code>端口http服务。再使用<code>acme.sh</code>在<code>ZeroSSL</code>或者<code>Let&#39;s Encrypt</code>上<a target="_blank" rel="noopener" href="https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E">自动申请证书</a>，然后使用<code>frp</code><a target="_blank" rel="noopener" href="https://gofrp.org/zh-cn/docs/examples/https2http/">为本地 HTTP 服务启用 HTTPS | frp</a>，</p>
<p>然而你也可以不使用<code>frp</code>做<code>https</code>服务，那么你需要使用<code>nginx</code>进行认证，你可以参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chuanghongmeng/p/18466820">免费永久HTTPS(ssl)证书——Let’s Encrypt来了 - 大司徒 - 博客园</a>。</p>
<p>让我们开始HTTP<font color='red'>S</font>。</p>
<h1 id="frps"><a href="#frps" class="headerlink" title="frps"></a>frps</h1><p>你需要启用<code>frps</code>的<code>https</code>穿透，具体配置文件为：</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bindPort</span> = <span class="number">7000</span></span><br><span class="line"><span class="attr">vhostHTTPPort</span> = <span class="number">80</span></span><br><span class="line"><span class="attr">vhostHTTPSPort</span> = <span class="number">443</span></span><br><span class="line"><span class="attr">webServer.addr</span> = <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"><span class="attr">webServer.port</span> = <span class="number">7500</span></span><br><span class="line"><span class="attr">webServer.user</span> = <span class="string">&quot;****&quot;</span></span><br><span class="line"><span class="attr">webServer.password</span> = <span class="string">&quot;****&quot;</span></span><br><span class="line"><span class="attr">enablePrometheus</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">auth.token</span> = <span class="string">&quot;****&quot;</span></span><br></pre></td></tr></table></figure>

<p>重要的是你的<code>vhostHTTPSPort</code>字段，其他的请不要修改。修改完配置后重启<code>frps</code>，并打开你服务器的<code>443</code>端口。</p>
<h1 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h1><p>为什么使用<code>nginx</code>？<del>因为我只会用这个</del>，并且它的配置文件很有意思，且好玩。</p>
<h2 id="使用frp"><a href="#使用frp" class="headerlink" title="使用frp"></a>使用frp</h2><p>如果你使用了<code>frp</code>，那么你就不需要在<code>nginx</code>中设置<code>443</code>端口的<code>https</code>服务，只需要开放本机上的<code>http</code>服务即可。请修改下面的<code>&lt;yourservername&gt;</code>为你想要的名字。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /etc/nginx/sites-available/default /etc/nginx/sites-available/&lt;yourservername&gt;</span><br><span class="line"><span class="built_in">ln</span> -s /etc/nginx/sites-available/&lt;yourservername&gt; /etc/nginx/sites-enabled/&lt;yourservername&gt;</span><br></pre></td></tr></table></figure>
<p>并将下面的配置文件写入你创建的文件中。请修改下面的<code>&lt;your server path&gt;</code>为你的网站路径，修改下面的<code>&lt;your domain&gt;</code>为你的域名。</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">81</span>;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^(.*)$</span> https://<span class="variable">$host</span><span class="variable">$1</span> <span class="literal">permanent</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">root</span> &lt;your server path&gt; ;</span><br><span class="line">        <span class="attribute">index</span> index.html;</span><br><span class="line">        <span class="attribute">server_name</span> &lt;your domain&gt; ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后重启<code>nginx</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart nginx</span><br></pre></td></tr></table></figure>

<h1 id="acme-sh"><a href="#acme-sh" class="headerlink" title="acme.sh"></a>acme.sh</h1><p>我使用了<a target="_blank" rel="noopener" href="https://github.com/acmesh-official/acme.sh">acme.sh</a>项目来实现证书的申请和自动更新！🥰<br>这是令人兴奋的，但是我有义务让你知道免费SSL证书的来源！我是从这篇知乎文章得知了这一渠道：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/22869797">为什么 SSL 证书要花钱购买，而不是政府免费发放的？怎么知道卖证书的是否可信呢？</a></p>
<p>接下来，让我们开始吧！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line"><span class="built_in">sudo</span> apt update &amp;&amp; <span class="built_in">sudo</span> apt install unzip socat</span><br></pre></td></tr></table></figure>
<p>然后你需要准备一个邮箱，并尝试运行下面的命令来下载acme.sh：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl https://get.acme.sh | sh -s email=my@example.com</span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>

<h2 id="使用frp-1"><a href="#使用frp-1" class="headerlink" title="使用frp"></a>使用frp</h2><p>接下来你需要准备：</p>
<ul>
<li>申请证书的域名</li>
<li>服务的根目录<br>并填入下面的命令，尝试执行它。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --issue -d mydomain.com -d www.mydomain.com --webroot /home/wwwroot/mydomain.com/</span><br></pre></td></tr></table></figure>
<p>然后你需要选择两个路径位置，用于存档<code>cert</code>和<code>key</code>，你可以直接使用下面命令中的路径，否则你应该记住自己使用的路径，你应该修改下面的域名为你自己设置的域名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /etc/nginx/ssl</span><br><span class="line">acme.sh --install-cert -d example.com \</span><br><span class="line">--key-file       /etc/nginx/ssl/key.pem  \</span><br><span class="line">--fullchain-file /etc/nginx/ssl/cert.pem \</span><br><span class="line">--reloadcmd     <span class="string">&quot;service nginx reload&quot;</span></span><br></pre></td></tr></table></figure>



<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>到这里你可以使用下面的命令来查看是否成功安装证书了！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">acme.sh --info -d example.com</span><br></pre></td></tr></table></figure>

<p>并且你可以查看自己的定时任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>

<h1 id="上线网站"><a href="#上线网站" class="headerlink" title="上线网站"></a>上线网站</h1><p>对于不使用<code>frp</code>的用户，其实重启<code>nginx</code>就可以正常工作了，但是对于<code>frp</code>用户，还需要进行一些<code>frpc</code>的配置。</p>
<p>打开你的<code>frpc.toml</code>，输入下面的配置：<br>你可以参考：<a target="_blank" rel="noopener" href="https://gofrp.org/zh-cn/docs/examples/https2http/">为本地 HTTP 服务启用 HTTPS | frp</a></p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">serverAddr</span> = <span class="string">&quot;x.x.x.x&quot;</span></span><br><span class="line"><span class="attr">serverPort</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[[proxies]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;test_htts2http&quot;</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;https&quot;</span></span><br><span class="line"><span class="attr">customDomains</span> = [<span class="string">&quot;domain&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[proxies.plugin]</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;https2http&quot;</span></span><br><span class="line"><span class="attr">localAddr</span> = <span class="string">&quot;127.0.0.1:80&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTPS 证书相关的配置</span></span><br><span class="line"><span class="attr">crtPath</span> = <span class="string">&quot;./server.crt&quot;</span></span><br><span class="line"><span class="attr">keyPath</span> = <span class="string">&quot;./server.key&quot;</span></span><br><span class="line"><span class="attr">hostHeaderRewrite</span> = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">requestHeaders.set.x-from-where</span> = <span class="string">&quot;frp&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>并额外添加一个<code>http</code>的服务：</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[[proxies]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;httpname&quot;</span></span><br><span class="line"><span class="attr">type</span> = <span class="string">&quot;http&quot;</span></span><br><span class="line"><span class="attr">localIP</span> = <span class="string">&quot;localhost&quot;</span></span><br><span class="line"><span class="attr">localPort</span> = <span class="number">81</span></span><br><span class="line"><span class="attr">customDomains</span> = [<span class="string">&quot;domain&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>最后重启<code>frpc</code>！大功告成！👋🛠️</p>
<p>如果有任何问题，欢迎向我提问！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Linux/实现自己的SHELL" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/61408/" class="article-date">
      <time datetime="2025-03-10T21:53:00.000Z" itemprop="datePublished">2025-03-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/61408/">实现自己的SHELL</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这篇文章会从头开始使用<code>C</code>语言编写一个可以交互的SHELL，并为其添加以下功能：</p>
<ul>
<li>运行可执行文件</li>
<li>输入中断退出</li>
<li>cd&#x2F;export&#x2F;env&#x2F;exit 内建命令</li>
<li>实现了<code>|</code>管道通信</li>
<li>实现了部分内部命令自动高亮<code>ls/grep/cat</code></li>
<li>记录历史命令</li>
<li>检查运行环境</li>
</ul>
<p>未实现功能：</p>
<ul>
<li>&amp; 后台任务 &#x2F; fg &#x2F; bg 恢复执行</li>
<li>&amp;&amp;  依赖任务</li>
<li>|| 多任务</li>
<li><blockquote>
<p>&#x2F; &gt;&gt; 重定向</p>
</blockquote>
</li>
</ul>
<h1 id="任务要求"><a href="#任务要求" class="headerlink" title="任务要求"></a>任务要求</h1><ul>
<li>（1） 实现一个模拟的shell</li>
<li>（2） 实现一个管道通信程序</li>
</ul>
<p>其实书上的写的任务里这些是独立的几个任务，但是我没注意看书上的要求，于是把（1）（2）都写在了SHELL中，也就是说我实现了一个可以使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /path/to/file | grep symbel | grep symbel2</span><br></pre></td></tr></table></figure>
<p>类似机制的指令的SHELL。这里记录、分析一下用到的一些系统调用&#x2F;库函数。</p>
<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>使用了<code>readline</code>库，并且使用了<code>Linux</code>管道调用，所以不能在<code>Windows</code>上复现。<br>安装<code>readline</code>库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update &amp;&amp; <span class="built_in">sudo</span> apt install libreadline-dev</span><br></pre></td></tr></table></figure>

<h1 id="创建简单的SHELL部分"><a href="#创建简单的SHELL部分" class="headerlink" title="创建简单的SHELL部分"></a>创建简单的SHELL部分</h1><p>对于shell，最重要最简单的功能就是能够读懂用户的指令了，比如最简单的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cat</span> file</span><br><span class="line">vim file</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">cd</span> path</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">export</span> something=anotherthing</span><br><span class="line"><span class="built_in">env</span></span><br><span class="line">^D</span><br></pre></td></tr></table></figure>
<p>又或者复杂一些的命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> | grep pro</span><br><span class="line">./exe &amp;&amp; ./exe2 || ./exe3</span><br></pre></td></tr></table></figure>

<p>我们的主函数的逻辑就像下面的结构：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> *input;</span><br><span class="line">    <span class="type">char</span> *prompt;</span><br><span class="line">    <span class="type">char</span> **args;</span><br><span class="line">	setup_signal_handlers();</span><br><span class="line">    rl_attempted_completion_function = shell_completion;</span><br><span class="line">    welcome();</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        prompt = get_prompt();</span><br><span class="line">        input = readline(prompt);</span><br><span class="line">        <span class="built_in">free</span>(prompt);</span><br><span class="line">        <span class="keyword">if</span> (!input) &#123;</span><br><span class="line">            exit_shell();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strlen</span>(input) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            add_history(input);</span><br><span class="line">            execute_command(input);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(input);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="信号处理"><a href="#信号处理" class="headerlink" title="信号处理"></a>信号处理</h2><p>从上往下看，首先第一个函数<code>setup_signal_handlers</code>，你需要在这里处理shell的信号机制，比如用户的中断信号<code>Ctrl+C</code>。普通的程序会使用正常的中断退出，但是作为一个shell，不应该在用户发出<code>Ctrl+C</code>中断信号的时候退出，而是应该处理<code>Ctrl+D</code>的输入终止信号才退出，所以我们可以得到一个简单的<code>setup_ignal_handlers</code>函数的定义：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">setup_signal_handlers</span><span class="params">()</span> &#123;</span><br><span class="line">    signal(SIGINT, SIG_IGN);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的<code>signal</code>函数很重要，它的函数声明和使用示例为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reference</span></span><br><span class="line">**<span class="type">void</span> (*signal(<span class="type">int</span> sig, <span class="type">void</span> (*func)(<span class="type">int</span>)))(<span class="type">int</span>)**</span><br><span class="line"><span class="comment">// sample</span></span><br><span class="line">signal(SIGINT, handleInterupt);<span class="comment">// 自定义函数处理</span></span><br><span class="line">signal(SIGINT, SIG_IGN);<span class="comment">// 不处理</span></span><br><span class="line">signal(SIGILL, SIG_DFL);<span class="comment">// 默认处理</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>具体的细节可以参考菜鸟教程：<a target="_blank" rel="noopener" href="https://www.runoob.com/cprogramming/c-function-signal.html">C 库函数 – signal() | 菜鸟教程</a></p>
<p>我们只需要忽略掉<code>SIGINT</code>信号即可。</p>
<h2 id="正则补全"><a href="#正则补全" class="headerlink" title="正则补全"></a>正则补全</h2><p>然后是下面这行神奇的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;readline/readline.h&gt;</span></span></span><br><span class="line">rl_attempted_completion_function = shell_completion;</span><br></pre></td></tr></table></figure>
<p>右边是一个形如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> **<span class="title function_">rl_completion_func_t</span><span class="params">(<span class="type">const</span> <span class="type">char</span> * test, <span class="type">int</span> start, <span class="type">int</span> end)</span></span><br></pre></td></tr></table></figure>
<p>的函数指针。该函数需要处理用户输入的不完整字符串的补全结果。<code>readline</code>库提供了一个正则匹配的函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">char</span> **rl_completion_matches <span class="title function_">PARAMS</span><span class="params">((<span class="type">const</span> <span class="type">char</span> *, <span class="type">rl_compentry_func_t</span> *))</span>;</span><br><span class="line"><span class="comment">// sample</span></span><br><span class="line"><span class="type">rl_compentry_func_t</span> *generator = command_generator;</span><br><span class="line"><span class="type">char</span>* result = rl_completion_matches(text, generator);</span><br></pre></td></tr></table></figure>
<p>上面的示例中，我们需要定义一个正则规则函数，形如：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">command_generator</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *text, <span class="type">int</span> state)</span>;</span><br></pre></td></tr></table></figure>
<p>的匹配函数，在这个函数中返回我们补全的结果。如果想要了解更多<code>Readline</code>中的补全机制，可以参考这篇博客。也可以直接读我的源码。<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LiuYanYGZ/p/14806474.html">ReadLine自动补全分析 - LiuYanYGZ - 博客园</a><br>其实<code>re_attempted_aompeltion_function</code>类似于一个回调函数，会在用户按下<code>Tab</code>的时候尝试补全。</p>
<h2 id="命令处理主体"><a href="#命令处理主体" class="headerlink" title="命令处理主体"></a>命令处理主体</h2><p>再往后看，就是我们的函数主体了，在while循环中，我们需要处理用户的<code>Enter</code>输入，并执行对应的操作。并且需要为用户提供当前运行环境的一些信息，包括用户名、机器信息、路径信息等。这部分操作我们在<code>get_prompt</code>中实现，你可以随心所欲地实现你想要的提示词：</p>
<h3 id="prompt"><a href="#prompt" class="headerlink" title="prompt"></a>prompt</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">get_prompt</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> cwd[<span class="number">1024</span>];</span><br><span class="line">    <span class="type">char</span> *prompt = <span class="built_in">malloc</span>(<span class="number">1024</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">passwd</span> *<span class="title">pw</span> =</span> getpwuid(getuid());</span><br><span class="line">    <span class="keyword">if</span> (getcwd(cwd, <span class="keyword">sizeof</span>(cwd)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(cwd, <span class="string">&quot;?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">snprintf</span>(prompt, <span class="number">1024</span>, <span class="string">&quot;%s%s@%s%s:%s%s%s$ &quot;</span>, GREEN,</span><br><span class="line">             pw-&gt;pw_name, <span class="string">&quot;myshell&quot;</span>, RESET, BLUE, cwd, RESET);</span><br><span class="line">    <span class="keyword">return</span> prompt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里调用了<code>getpwuid</code>、<code>getuid</code>、<code>getcwd</code>三个函数，你需要引入这些头文件：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pwd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> &lt;unistd.H.</span></span><br></pre></td></tr></table></figure>

<h3 id="add-history"><a href="#add-history" class="headerlink" title="add_history"></a>add_history</h3><p><code>add_history</code>是<code>readline</code>库提供的一个保存命令历史的函数，允许用户使用上下来查阅历史记录。因为上下箭头其实输入的也是一个字符串，可以判断并执行对应的操作。</p>
<h3 id="execute-command"><a href="#execute-command" class="headerlink" title="execute_command"></a>execute_command</h3><p>执行命令！到这里，用户已经输入了一个完整&#x2F;不完整的命令，并按下了回车键，他希望你能帮他调用这些可执行文件，并得到对应的输出&#x2F;或重定向到其他地方。首先允许我为你介绍一个分词函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * <span class="title function_">strtok</span> <span class="params">(<span class="type">char</span> *str, <span class="type">const</span> <span class="type">char</span> * delimiters)</span>;</span><br></pre></td></tr></table></figure>
<p>需要注意的是，这个函数会将第一参数分割，所以在处理它的时候需要进行复制处理。</p>
<p>下面是一个简单的循环取词的示例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> * input = <span class="string">&quot;I need a friend.&quot;</span>;</span><br><span class="line"><span class="type">char</span> output[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="type">char</span> * word = strtok(input, <span class="string">&quot; \t\n&quot;</span>);</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(word!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">	output[i] = word;</span><br><span class="line">	word = strtok(<span class="literal">NULL</span>, <span class="string">&quot; \t\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>更多有关strtok的信息，请参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhangshenghui/p/7911051.html">(十六)strtok、strtok_s、strtok_r 字符串分割函数 - xtusir - 博客园</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/Yelee/categories/Linux/">Linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Yelee/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" rel="tag">技术文档</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Linux/gitea/runner/不使用docker的gitea runner配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/29b61e029340/" class="article-date">
      <time datetime="2025-03-05T13:55:00.000Z" itemprop="datePublished">2025-03-05</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/29b61e029340/">不适用docker的gitea runner配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近在为我的gitea服务添加Actions模块，但是发现官网的方式有一个严重的问题：docker内无法正常访问外网，于是我就想使用自建容器来实现在本地运行的runner。下面是官网教程：<br><a target="_blank" rel="noopener" href="https://docs.gitea.com/zh-cn/usage/actions/overview">Overview | Gitea Documentation</a><br>趁着容器复制的时间来写了这篇记录文档。</p>
<h2 id="安装act-runner"><a href="#安装act-runner" class="headerlink" title="安装act_runner"></a>安装act_runner</h2><p>目标机器需要安装<a target="_blank" rel="noopener" href="https://gitea.com/gitea/act_runner">gitea&#x2F;act_runner: A runner for Gitea based on act. - act_runner - Gitea: Git with a cup of tea</a>，用于向自己的服务注册一个runner。下载自己对应的版本就可以了。然后需要创建一个配置文件，其中你的token可以在你自己的gitea管理界面下的action找到。如果找不到请查阅官方文档。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交互形式</span></span><br><span class="line">wget https://gitea.com/gitea/act_runner/releases/download/v0.2.11/act_runner-0.2.11-linux-amd64</span><br><span class="line"><span class="built_in">mv</span> act_runner-0.2.11-linux-amd64 act_runner</span><br><span class="line"><span class="built_in">mkdir</span> runner &amp;&amp; <span class="built_in">mv</span> act_runner runner &amp;&amp; <span class="built_in">cd</span> runner</span><br><span class="line"><span class="built_in">chmod</span> +x act_runner</span><br><span class="line">./act_runner register</span><br><span class="line">./act_runner generate-config &gt; config.yaml</span><br><span class="line">vim config.yaml</span><br></pre></td></tr></table></figure>
<p>要将它默认的几个容器配置删除，找到labels下的，修改为以下结构，其实就是去除了容器的形式，只允许使用host运行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">*** config.yaml 2025-03-05 05:13:35.480359027 +0000</span><br><span class="line">--- config.yaml.bk      2025-03-05 05:10:54.361732625 +0000</span><br><span class="line">***************</span><br><span class="line">*** 40,43 ****</span><br><span class="line">    labels:</span><br><span class="line">!     - <span class="string">&quot;ubuntu:host&quot;</span></span><br><span class="line">!</span><br><span class="line"></span><br><span class="line">--- 40,44 ----</span><br><span class="line">    labels:</span><br><span class="line">!     - <span class="string">&quot;ubuntu-latest:docker://gitea/runner-images:ubuntu-latest&quot;</span></span><br><span class="line">!     - <span class="string">&quot;ubuntu-22.04:docker://gitea/runner-images:ubuntu-22.04&quot;</span></span><br><span class="line">!     - <span class="string">&quot;ubuntu-20.04:docker://gitea/runner-images:ubuntu-20.04&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后运行测试一下是否能正常启动：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./act_runner daemon --config config.yaml</span><br></pre></td></tr></table></figure>
<p>成功的输出大概是这样：<br><img src="/Yelee/../../../../assets/images/QQ_1741152400451.png"><br>然后<code>Ctrl+C</code>终止它，回到工作目录，准备安装node。</p>
<h2 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h2><p>来到官网，选择最新版，Linux和你最喜欢的下载器，这里我使用<code>NVM</code>测试。<br><a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/download">Node.js — Download Node.js®</a><br>提前安装必须工具：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install curl</span><br></pre></td></tr></table></figure>
<p>下面的指令或许需要科学上网，请自行准备本机科学上网方式。<br>安装<code>nvm</code></p>
<figure class="highlight plaintext"><figcaption><span>and install nvm:</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -okh</span><br><span class="line"># Download and install nvm:</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash</span><br><span class="line"></span><br><span class="line"># in lieu of restarting the shell</span><br><span class="line">\. &quot;$HOME/.nvm/nvm.sh&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里提供一个nvm换源的方法：<a target="_blank" rel="noopener" href="https://nvm.p6p.net/use/mirror.html">nvm 切换国内镜像 | NVM</a><br>安装<code>node</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 换源前</span></span><br><span class="line">nvm install 22</span><br><span class="line"><span class="comment"># 换源后</span></span><br><span class="line">nvm install 22.0.0</span><br></pre></td></tr></table></figure>
<p>国内源很快，安装完后检查版本：<br><img src="/Yelee/../../../../assets/images/QQ_1741153303960.png"></p>
<h2 id="构建一个简单的测试"><a href="#构建一个简单的测试" class="headerlink" title="构建一个简单的测试"></a>构建一个简单的测试</h2><p>首先启动你的runner</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./act_runner daemon --config config.yaml</span><br></pre></td></tr></table></figure>
<p>然后在你的任意仓库建立一个文件：&#96;.gitea&#x2F;workflows&#x2F;demo.yaml’写入以下内容：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Gitea</span> <span class="string">Actions</span> <span class="string">Demo</span></span><br><span class="line"><span class="attr">run-name:</span> <span class="string">$&#123;&#123;</span> <span class="string">gitea.actor</span> <span class="string">&#125;&#125;</span> <span class="string">is</span> <span class="string">testing</span> <span class="string">out</span> <span class="string">Gitea</span> <span class="string">Actions</span> <span class="string">🚀</span></span><br><span class="line"><span class="attr">on:</span> [<span class="string">push</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">Explore-Gitea-Actions:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;🎉 The job was automatically triggered by a $<span class="template-variable">&#123;&#123; gitea.event_name &#125;&#125;</span> event.&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;🐧 This job is now running on a $<span class="template-variable">&#123;&#123; runner.os &#125;&#125;</span> server hosted by Gitea!&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;🔎 The name of your branch is $<span class="template-variable">&#123;&#123; gitea.ref &#125;&#125;</span> and your repository is $<span class="template-variable">&#123;&#123; gitea.repository &#125;&#125;</span>.&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Check</span> <span class="string">out</span> <span class="string">repository</span> <span class="string">code</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;💡 The $<span class="template-variable">&#123;&#123; gitea.repository &#125;&#125;</span> repository has been cloned to the runner.&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;🖥️ The workflow is now ready to test your code on the runner.&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">List</span> <span class="string">files</span> <span class="string">in</span> <span class="string">the</span> <span class="string">repository</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          ls $&#123;&#123; gitea.workspace &#125;&#125;</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">echo</span> <span class="string">&quot;🍏 This job&#x27;s status is $<span class="template-variable">&#123;&#123; job.status &#125;&#125;</span>.&quot;</span></span><br></pre></td></tr></table></figure>
<p>这里最重要的是<code>runs-on</code>，需要配置为上面你在<code>config.yaml</code>文件里<code>labels</code>下定义的runner中选一个。Push后会自动开始构建，构建成功就像这样：<br><img src="/Yelee/../../../../assets/images/QQ_1741153804750.png"><br>那么就大功告成了！然后就可以尝试其他的action了！</p>
<h2 id="镜像actions-checkout仓库"><a href="#镜像actions-checkout仓库" class="headerlink" title="镜像actions&#x2F;checkout仓库"></a>镜像actions&#x2F;checkout仓库</h2><p>在我的测试用，如果runner机器与github的联通不是很通畅的话，尝试从github拉取action的时候会出现错误，所以可以选择从自己的仓库中拉取，在上面的<code>demo.yaml</code>文件中，修改<code>uses:</code>字段为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- uses: http://&lt;您的gitea服务器地址&gt;/actions/checkout@v4</span><br></pre></td></tr></table></figure>
<p>即可访问，但是注意需要将镜像的仓库转让给actions组织，转让仓库可以在仓库设置的最下方找到：</p>
<h2 id="给git加代理"><a href="#给git加代理" class="headerlink" title="给git加代理"></a>给git加代理</h2><p>不过我建议直接给runner加上git的代理，这样可以最方便地移植github上的action。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy &lt;your proxy addr&gt;</span><br><span class="line">git config --global https.proxy &lt;your proxy addr&gt;</span><br></pre></td></tr></table></figure>

<p>那这篇文章就到这里咯，谢谢您的阅读！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/Yelee/categories/Linux/">Linux</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Yelee/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" rel="tag">技术文档</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-CG/OpenGL/如何在Ubuntu上使用Cmake编译Glut" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/34e784d46b0a/" class="article-date">
      <time datetime="2025-02-27T18:40:00.000Z" itemprop="datePublished">2025-02-27</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/34e784d46b0a/">如何在Ubuntu上使用Cmake编译Glut</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>2025-02-27 06:42:27<br>时隔一年，我再次重拾计算机图形学，内心怀揣着激动。面试官的一言，让我又燃起了对渲染的渴望。借着计算机图形学课程的机会，我想要重新认识一下这些经典的算法，并花一个学期的时间，编写一个软渲染的管线。我非常感谢字节的面试官。是他让我看到了工业界对渲染的需求，也让我再次燃起了大一刚学习图形学时的激情。</p>
<p>首先在开始前，明确一下我的测试环境。我使用的是Ubuntu22.04进行下面的流程测试。</p>
<h1 id="依赖下载"><a href="#依赖下载" class="headerlink" title="依赖下载"></a>依赖下载</h1><p>首先我们安装一些必须的依赖，方便我们自己编译freeglut和opencv。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install cmake g++ gcc pkg-config build-essential unzip</span><br></pre></td></tr></table></figure>
<p>然后我们可以前往<a target="_blank" rel="noopener" href="https://freeglut.sourceforge.net/">freeglut官网</a>和<a target="_blank" rel="noopener" href="https://opencv.org/releases/">opencv官网</a>找到它们的发行版本，直接下载源码即可。测试使用的版本如下：</p>
<ul>
<li><ul>
<li>OpenCV – 4.11.0</li>
</ul>
</li>
<li>freeglut - 3.6.0</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/opencv/opencv/archive/refs/tags/4.11.0.zip</span><br><span class="line">wget https://github.com/freeglut/freeglut/releases/download/v3.6.0/freeglut-3.6.0.tar.gz</span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">unzip 4.11.0.zip</span><br><span class="line">tar -xvf freeglut-3.6.0.tar.gz</span><br></pre></td></tr></table></figure>

<h1 id="编译glut和opencv"><a href="#编译glut和opencv" class="headerlink" title="编译glut和opencv"></a>编译glut和opencv</h1><h2 id="glut"><a href="#glut" class="headerlink" title="glut"></a>glut</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> freeglut-3.6.0</span><br><span class="line">cmake -S . -B build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">make -j56</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure>
<p>这里记住安装的路径，一般为<code>/usr/local/lib/</code>。</p>
<h2 id="opencv"><a href="#opencv" class="headerlink" title="opencv"></a>opencv</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> opencv-4.11.0</span><br><span class="line">cmake -S . -B build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">make -j56</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br></pre></td></tr></table></figure>

<h2 id="配置pkg-config"><a href="#配置pkg-config" class="headerlink" title="配置pkg-config"></a>配置pkg-config</h2><p>编译并安装好动态&#x2F;静态库后，我们要配置pkg-config的索引，前面的依赖安装中安装了<code>pkg-config</code>，你可以用这个测试它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PKG_CONFIG_PATH</span></span><br></pre></td></tr></table></figure>
<p>有可能这个变量是空的，我们主要通过设置这个环境变量来添加pkg索引。你可以在任何你熟悉的地方编写环境变量的加载，这里我们使用profile.d&#x2F;来添加。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /etc/profile/pkgconfig.sh</span><br><span class="line">vim !$</span><br></pre></td></tr></table></figure>
<p>将<code>export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig:$PKG_CONFIG_PATH</code>加入该文件的最后一行。然后检查自己的库是否能被索引到：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg-config --libs opencv4</span><br><span class="line">pkg-config --libs glut</span><br></pre></td></tr></table></figure>
<p>类似的输出是正确的：<br><img src="/Yelee/../../../assets/images/QQ_1740674586875.png"></p>
<h2 id="配置ld"><a href="#配置ld" class="headerlink" title="配置ld"></a>配置ld</h2><p>然后我们需要为两个库编写ld conf。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/ld.so.conf.d/glut.conf</span><br><span class="line"><span class="built_in">sudo</span> vim /etc/ld.so.conf.d/opencv4.conf</span><br></pre></td></tr></table></figure>
<p>最后重新载入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ldconfig</span><br></pre></td></tr></table></figure>
<p>两个文件都只需要写入<code>/usr/local/lib</code>即可。</p>
<h1 id="CMakeLists-txt"><a href="#CMakeLists-txt" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h1><p>这里使用了头歌上的两个简单的绘制代码来测试我们最后的环境：</p>
<h2 id="student-h"><a href="#student-h" class="headerlink" title="student.h"></a>student.h</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// student.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;GL/freeglut.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myDisplay</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 请在此添加代码，调用glClearColor函数</span></span><br><span class="line">    <span class="comment">/********** Begin *********/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/********** End **********/</span></span><br><span class="line">        <span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT);</span><br><span class="line">        <span class="comment">// 请在此添加代码，实现其他渲染功能</span></span><br><span class="line">    <span class="comment">/********** Begin *********/</span></span><br><span class="line">                                        <span class="comment">//设置长方形颜色</span></span><br><span class="line">                                        <span class="comment">//设置长方形位置</span></span><br><span class="line">                                        <span class="comment">//将图形类型选定为三角形GL_TRIANGLES</span></span><br><span class="line">                                        <span class="comment">//设置三角形顶点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//设置三角形顶点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//设置三角形顶点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//调用glEnd</span></span><br><span class="line">                                        <span class="comment">//设置渲染点直径</span></span><br><span class="line">                                        <span class="comment">//将图形类型选定为点GL_POINTS</span></span><br><span class="line">                                        <span class="comment">//设置渲染点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//设置渲染点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//设置渲染点颜色和位置</span></span><br><span class="line">                                        <span class="comment">//调用glEnd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/********** End **********/</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">glFlush</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="test-cpp"><a href="#test-cpp" class="headerlink" title="test.cpp"></a>test.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//test.cpp</span></span><br><span class="line"><span class="comment">// 提示：写完代码请保存之后再进行评测</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;GL/freeglut.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 评测代码所用头文件-开始</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/core/core.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line"> <span class="comment">// 评测代码所用头文件-结束</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">(2).绘制一个矩形，颜色为(1.0f,1.0f,1.0f)，矩阵位置（-0.5f，-0.5f，0.5f，0.5f)；</span></span><br><span class="line"><span class="comment">(3).绘制一个三角形，三个顶点颜色分别为（1.0f, 0.0f, 0.0f), (0.0f,1.0f,0.0f)， (0.0f,0.0f,1.0f)，对应的顶点坐标分别为(0.0f,1.0f), (0.8f,-0.5f),  (-0.8f,-0.5f)；</span></span><br><span class="line"><span class="comment">(4).绘制三个直径为3的点，颜色为（1.0f, 0.0f, 0.0f)， (0.0f,1.0f,0.0f)， (0.0f,0.0f,1.0f)，对应的顶点坐标分别为（-0.4f,-0.4f), (0.0f,0.0f)，(0.4f,0.4f)。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myDisplay</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 请在此添加你的代码</span></span><br><span class="line">  <span class="comment">/********** Begin ********/</span></span><br><span class="line">  <span class="built_in">glClearColor</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">  <span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT);</span><br><span class="line">        <span class="built_in">glPointSize</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">glBegin</span>(GL_QUADS);</span><br><span class="line">  <span class="built_in">glColor3f</span>(<span class="number">1.0f</span>, <span class="number">1.0f</span>, <span class="number">1.0f</span>);</span><br><span class="line">  <span class="built_in">glVertex2f</span>(<span class="number">-0.5f</span>,<span class="number">-0.5f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">-0.5f</span>,<span class="number">0.5f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">0.5f</span>,<span class="number">0.5f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">0.5f</span>,<span class="number">-0.5f</span>);</span><br><span class="line">  <span class="built_in">glEnd</span>();</span><br><span class="line"></span><br><span class="line">  <span class="built_in">glBegin</span>(GL_TRIANGLES);</span><br><span class="line">  <span class="built_in">glColor3f</span>(<span class="number">1.0f</span>,<span class="number">0.0f</span>,<span class="number">0.0f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">0.0f</span>,<span class="number">1.0f</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">glColor3f</span>(<span class="number">0.0f</span>,<span class="number">1.0f</span>,<span class="number">0.0f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">0.8f</span>,<span class="number">-0.5f</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">glColor3f</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);</span><br><span class="line">        <span class="built_in">glVertex2f</span>(<span class="number">-0.8f</span>,<span class="number">-0.5f</span>);</span><br><span class="line">  <span class="built_in">glEnd</span>();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">glPointSize</span>(<span class="number">3</span>);</span><br><span class="line">  <span class="built_in">glBegin</span>(GL_POINTS);</span><br><span class="line">  <span class="built_in">glColor3f</span>(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">  <span class="built_in">glVertex2f</span>(<span class="number">-0.4f</span>, <span class="number">-0.4f</span>);</span><br><span class="line">  <span class="built_in">glColor3f</span>(<span class="number">0.0f</span>, <span class="number">1.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">  <span class="built_in">glVertex2f</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>);</span><br><span class="line">  <span class="built_in">glColor3f</span>(<span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>);</span><br><span class="line">  <span class="built_in">glVertex2f</span>(<span class="number">0.4f</span>, <span class="number">0.4f</span>);</span><br><span class="line">  <span class="built_in">glEnd</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/********** End **********/</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">glFlush</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> * argv[])</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">glutInit</span>( &amp; argc, argv);</span><br><span class="line">  <span class="built_in">glutInitWindowPosition</span>(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">  <span class="built_in">glutInitWindowSize</span>(<span class="number">400</span>, <span class="number">400</span>);</span><br><span class="line">  <span class="built_in">glutCreateWindow</span>(<span class="string">&quot;Hello Point!&quot;</span>);</span><br><span class="line">  <span class="built_in">glutDisplayFunc</span>( &amp; myDisplay);</span><br><span class="line">  <span class="built_in">glutMainLoopEvent</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*************以下为评测代码，与本次实验内容无关，请勿修改**************/</span></span><br><span class="line">  GLubyte * pPixelData = (GLubyte * ) <span class="built_in">malloc</span>(<span class="number">400</span> * <span class="number">400</span> * <span class="number">3</span>); <span class="comment">//分配内存</span></span><br><span class="line">  GLint viewport[<span class="number">4</span>] = &#123;</span><br><span class="line">    <span class="number">0</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">glReadBuffer</span>(GL_FRONT);</span><br><span class="line">  <span class="built_in">glPixelStorei</span>(GL_UNPACK_ALIGNMENT, <span class="number">4</span>);</span><br><span class="line">  <span class="built_in">glGetIntegerv</span>(GL_VIEWPORT, viewport);</span><br><span class="line">  <span class="built_in">glReadPixels</span>(viewport[<span class="number">0</span>], viewport[<span class="number">1</span>], viewport[<span class="number">2</span>], viewport[<span class="number">3</span>], GL_RGB, GL_UNSIGNED_BYTE, pPixelData);</span><br><span class="line"></span><br><span class="line">  cv::Mat img;</span><br><span class="line">  std::vector &lt; cv::Mat &gt; imgPlanes;</span><br><span class="line">  img.<span class="built_in">create</span>(<span class="number">400</span>, <span class="number">400</span>, CV_8UC3);</span><br><span class="line">  cv::<span class="built_in">split</span>(img, imgPlanes);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">400</span>; i++) &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> * plane0Ptr = imgPlanes[<span class="number">0</span>].ptr &lt; <span class="type">unsigned</span> <span class="type">char</span> &gt; (i);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> * plane1Ptr = imgPlanes[<span class="number">1</span>].ptr &lt; <span class="type">unsigned</span> <span class="type">char</span> &gt; (i);</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> * plane2Ptr = imgPlanes[<span class="number">2</span>].ptr &lt; <span class="type">unsigned</span> <span class="type">char</span> &gt; (i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">400</span>; j++) &#123;</span><br><span class="line">      <span class="type">int</span> k = <span class="number">3</span> * (i * <span class="number">400</span> + j);</span><br><span class="line">      plane2Ptr[j] = pPixelData[k];</span><br><span class="line">      plane1Ptr[j] = pPixelData[k + <span class="number">1</span>];</span><br><span class="line">      plane0Ptr[j] = pPixelData[k + <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cv::<span class="built_in">merge</span>(imgPlanes, img);</span><br><span class="line">  cv::<span class="built_in">flip</span>(img, img, <span class="number">0</span>);</span><br><span class="line">  cv::<span class="built_in">namedWindow</span>(<span class="string">&quot;openglGrab&quot;</span>);</span><br><span class="line">  cv::<span class="built_in">imshow</span>(<span class="string">&quot;openglGrab&quot;</span>, img);</span><br><span class="line">  <span class="comment">//cv::waitKey();</span></span><br><span class="line">  cv::<span class="built_in">imwrite</span>(<span class="string">&quot;../img_step2/test.jpg&quot;</span>, img);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CMakeLists-txt-1"><a href="#CMakeLists-txt-1" class="headerlink" title="CMakeLists.txt"></a>CMakeLists.txt</h2><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.1</span>)</span><br><span class="line"><span class="keyword">project</span>(StartGLUT)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED)</span><br><span class="line"><span class="keyword">find_package</span>(OpenGL REQUIRED)</span><br><span class="line"><span class="keyword">find_package</span>(GLUT REQUIRED)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">11</span>)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD_REQUIRED <span class="keyword">TRUE</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_directories</span>($(OpenCV_INCLUDE_DIRS))</span><br><span class="line"><span class="keyword">include_directories</span>($(OpenGL_INCLUDE_DIRS))</span><br><span class="line"><span class="keyword">include_directories</span>($(GLUT_INCLUDE_DIRS))</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> test2.cpp student.h)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> <span class="variable">$&#123;OPENGL_LIBRARIES&#125;</span> <span class="variable">$&#123;GLUT_LIBRARIES&#125;</span> <span class="variable">$&#123;OpenCV_LIBRARIES&#125;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cmake -S . -B build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">make</span><br><span class="line">./StartGLUT</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/Yelee/categories/CG/">CG</a><a class="article-category-link" href="/Yelee/categories/CG/OpenGL/">OpenGL</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/Yelee/tags/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/" rel="tag">技术文档</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Linux/docker/docker设置代理与镜像站" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/Yelee/posts/d7880d8f2f2e/" class="article-date">
      <time datetime="2025-02-23T12:40:02.581Z" itemprop="datePublished">2025-02-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/Yelee/posts/d7880d8f2f2e/">docker 设置代理与镜像站</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl https://zhywyt.github.io/assets/bash/docker_proxy.sh | <span class="built_in">sudo</span> bash &lt;your proxy&gt;</span><br><span class="line"></span><br><span class="line">curl https://zhywyt.github.io/assets/bash/docker_proxy.sh | <span class="built_in">sudo</span> bash http://10.10.10.100:7890</span><br></pre></td></tr></table></figure>

<p><a href="../../assets/bash/docker_proxy.sh">脚本下载</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/Yelee/page/2/">2</a><a class="page-number" href="/Yelee/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/Yelee/page/9/">9</a><a class="extend next" rel="next" href="/Yelee/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2025 zhywyt
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/Yelee/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/Yelee//background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>